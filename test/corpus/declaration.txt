==============================
x' = 1
===============================

x' = 1

---

(source_file
  (declaration
    lhs: (identifier)
    rhs: (number)))


==============================
foo x y = bar (x, 42, "string", True, False) [y]
===============================

foo x y = bar (x, 42, "string", True, False) [y]

---

(source_file
  (declaration
    lhs: (identifier)
    arg: (identifier)
    arg: (identifier)
    rhs: (application
      (identifier)
      (tupleExpr
        (identifier)
        (number)
        (string)
        (true)
        (false))
      (listExpr
        (identifier)))))


==============================
record definition
===============================

x = { name = "Alice", age = 42 }

---

(source_file
  (declaration
    lhs: (identifier)
    rhs: (recordExpr
      (recordExprEntry
        (identifier)
        (string))
      (recordExprEntry
        (identifier)
        (number)))))

==============================
x r = x r@k1 . y r@k2
==============================

x r = x r@k1 . y r@k2

---

(source_file
  (declaration
    (identifier)
    (identifier)
    (composition
      (application
        (identifier)
        (recordAccess
          (identifier)
          (identifier)))
      (application
        (identifier)
        (recordAccess
          (identifier)
          (identifier))))))

==============================
foo x = (f x)@key
==============================

foo x = (f x)@key

---

(source_file
  (declaration
    (identifier)
    (identifier)
    (recordAccess
      (application
        (identifier)
        (identifier))
      (identifier))))

==============================
foo = {k = 1, r = 2}@k
==============================

foo = {k = 1, r = 2}@k

---

(source_file
  (declaration
    (identifier)
    (recordAccess
      (recordExpr
        (recordExprEntry
          (identifier)
          (number))
        (recordExprEntry
          (identifier)
          (number)))
      (identifier))))


===============================
foo = bar . baz
===============================

foo = bar . baz

---

(source_file
  (declaration
    lhs: (identifier)
    rhs: (composition
      (identifier)
      (identifier))))


===============================
foo = map (f . f)
===============================

foo = map (f . f)

---

(source_file
  (declaration
    (identifier)
    (application
      (identifier)
      (composition
        (identifier)
        (identifier)))))


==============================
foo x y = (bar x . baz y) 42
===============================

foo x y = (bar x . baz y) 42

---

(source_file
  (declaration
    lhs: (identifier)
    arg: (identifier)
    arg: (identifier)
    rhs: (application
      (composition
        (application
          (identifier)
          (identifier))
        (application
          (identifier)
          (identifier)))
      (number))))

==============================
foo = map (\x -> bar x)
===============================

foo = map (\x -> bar x)

---

(source_file
  (declaration
    lhs: (identifier)
    rhs: (application
      (identifier)
      (lambdaExpr
        (identifier)
        (application
          (identifier)
          (identifier))))))


==============================
multiple statements
===============================

x = 1
x = 2

---

(source_file
  (declaration
    lhs: (identifier)
    rhs: (number))
  (declaration
    lhs: (identifier)
    rhs: (number)))


==============================
nested wheres
===============================

x = 1
x = y where
    y = z where
        z = w where
            w = 1
    g = 4

---

(source_file
  (declaration
    lhs: (identifier)
    rhs: (number))
  (declaration
    lhs: (identifier)
    rhs: (identifier)
    where: (block
      (declaration
        lhs: (identifier)
        rhs: (identifier)
        where: (block
          (declaration
            lhs: (identifier)
            rhs: (identifier)
            where: (block
              (declaration
                lhs: (identifier)
                rhs: (number))))))
      (declaration
        lhs: (identifier)
        rhs: (number)))))


==============================
where spacing
===============================

x = 1
x = y where
    y = z

    z = w
---

(source_file
  (declaration
    (identifier)
    (number))
  (declaration
    (identifier)
    (identifier)
    (block
      (declaration
        (identifier)
        (identifier))
      (declaration
        (identifier)
        (identifier)))))

==============================
where spacing (non-zero blank)
===============================

x = 1    
x = y    where      
       
    y = z 
  
    z =    w
---

(source_file
  (declaration
    (identifier)
    (number))
  (declaration
    (identifier)
    (identifier)
    (block
      (declaration
        (identifier)
        (identifier))
      (declaration
        (identifier)
        (identifier)))))

==============================
nested wheres (spacing)
==============================

x = 1
x = y where

    y = z where
  
        z = w where
                          
            w = 1
    g = 4

---

(source_file
  (declaration
    lhs: (identifier)
    rhs: (number))
  (declaration
    lhs: (identifier)
    rhs: (identifier)
    where: (block
      (declaration
        lhs: (identifier)
        rhs: (identifier)
        where: (block
          (declaration
            lhs: (identifier)
            rhs: (identifier)
            where: (block
              (declaration
                lhs: (identifier)
                rhs: (number))))))
      (declaration
        lhs: (identifier)
        rhs: (number)))))


==============================
Signatures in where statements
==============================

f = bar 2.0 where
   bar :: Real -> Real
   bar x = add x 30.0

---

(source_file
  (declaration
    (identifier)
    (application
      (identifier)
      (number))
    (block
      (signature
        (identifier)
        (functionT
          (identifierU)
          (identifierU)))
      (declaration
        (identifier)
        (identifier)
        (application
          (identifier)
          (identifier)
          (number))))))
